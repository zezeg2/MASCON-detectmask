# MASCON-detectmask
graduation project : detect wearing mask


## 라즈베리파이를 활용한 공공시설 올바른 마스크 착용 안내 시스템



**서론**

COVID-19 팬데믹에 가장 화두가 된 것은 마스크이다. 사회적 거리두기 2단계 이상부터 실내 전체 마스크 착용을 의무화하였으나, 마스크로 코 밑에 걸치거나 턱으로 내려 착용한 이른바 ‘턱스크’의 경우가 많이 발견된다. 그 예로 공항철도 열차 내 마스크 착용 점검 결과 5일간 484건의 적발 사례(하루 평균 97건)이 나왔으며, 이는 마스크를 소지하지 않은 것 뿐 아니라 위와 같은 경우를 포함한 결과이다.

  Christian 외 1인은 비말 감염에 있어 마스크를 통한 예방 효과에 대한 연구[1]에서, 마스크를 착용하지 않고 

대화를 하는 것이 입부터 코까지 마스크로 가린 채 기침을 하는 것보다 더 많은 비말을 확산시킨다는 것을 보여준다.

 ![img](https://lh5.googleusercontent.com/BhHNgS-z_-FpIZE_X_87Lo1uj98dR1F_80I0PVmKAoaVyrS2x_JOY5oScNTmb6lhubdEYdVRKd7FxXr0V-fhybfUCeQs-wkK909prAjUUPnKMbD5dM1Cp7Uy4WqZW6n9V9-sJzJUcH8)

[2]또한 Yixuan J Hou 외 18인은 COVID-19 감염 경로에 대한 연구에서 비강(코)이 코로나 바이러스에 가작 취약한 부위임을 확인했다. 더불어 코에는 다른 호흡기보다 감염에 취약한 세포가 많기때문에 감염자가 코로 내쉬는 날숨에는 입으로 내뱉는 숨보다 바이러스 입자가 더 많을 수 있다고 지적했다.

  이처럼 ‘턱마스크’를 포함해 코를 내놓은 채 마스크를 쓰는 것은 자신은 물론 잠재적으로 타인에게 피해를 줄 수 있는 행동이다. 하지만 이러한 착용 실태를 수시로 점검하는 것은 많은 제약이 따른다. 이를 위해 특히 사람이 밀집되어 있는 공공장소 등에서 마스크를 올바르게 착용하지 않은 경우 알림음을 통해 안내를 돕는 시스템을 제안하고자 한다.

**연구 방법**

   라즈베리 파이 카메라 모듈을 활용해 스트리밍으로 영상을 입력 받아 Convolutional Network로 사람들의 얼굴을 인식하고 바르게 마스크를 착용하였는지 확인한다. 다양한 객체 검출 기술 중 임베디드에서도 실시간으로 작동할 수 있도록 경량화 된 네트워크인 Mobilene-v2을 활용한다. 

  학습을 위한 데이터는 Flickr-Faces-HQ Dataset(FFHQ)을 사용한다. FFHQ는 비영리 목적으로 라이센스가 허가된 얼굴 데이터셋이며 70,000장의 사진 중 3000 여장을 학습에 활용했다. Landmark detection을 통해 데이터셋 일부에 원하는 수준으로 마스크를 씌우고, 원본 사진과 함께 총 세 가지(with_mask, without_mask, wrong_mask) 레이블로 학습을 진행하였다. 



### 학습 데이터 생성

**데이터 확장의 필요성** 

 사람의 안면에 마스크를 착용 하거나 착용하지 않는 경우 이외에 올바르게 착용하지 않은, 소위 턱마스크, 코마스크라고 불리우는 방법으로 착용하는 사례가 많다. 인식하고자 하는 대상을 정확하게 인식시키도록 하기 위해서는 양질의 데이터를 올바르게 전처리 하여 적절하게 카테고리를 분류하고 데이터를 학습시키는 것이 바람직 하지만, 개개인이 항상 원하는 데이터셋만을 수집하는 것이 쉽지만은 않다. 따라서 데이터를 직접 생성하고 트레이닝 함으로써 분류성능이 뛰어난 모델을 만들고자 하였고 해당 프로젝트에서는 원본 이미지에서 마스크 이미지를 합성하는 방식으로 원본 이미지로부터 데이터를 확장하여 사용하고자 한다.

**얼굴인식 원리 이용**

- 사진 합성 방식
- **Face Recognition/ Face Landmark estimation**



### 데이터 트레이닝

- 전이학습

- **Mobilenet-v2** (base model)

  

  ### 라즈베리파이를 이용한 스트리밍



...



### Mask detection



**사용 모델**

- 영상에서 사람의 얼굴을 인식해서 찾아내는 모델 (res10_300x300_ssd_iter_140000)
- **데이터 트레이닝**에서 트레이닝 시킨 모델(test.model)을 사용



**자세한 내용은 문서 확인**
